<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Index — Flashlight Doodle</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Fira+Sans+Extra+Condensed:wght@400;700&display=swap');

  :root {
    --mx: 50%;
    --my: 50%;
    --r: 110px;   /* flashlight radius (px) */
    --f: 28px;    /* feather/soft edge (px) */
  }

  html, body {
    height: 100%;
    margin: 0;
    background: transparent; /* let the host page show through */
  }

  .stage {
    position: relative;
    width: 100%;
    height: 100%;
    min-width: 272px;
    min-height: 92px;
    display: grid;
    place-items: center;
    overflow: hidden;
    touch-action: none;
  }

  /* The logo text */
  .logo {
    position: relative;
    z-index: 0;
    font-family: "Fira Sans Extra Condensed", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    font-weight: 400;
    letter-spacing: .5px;
    line-height: 1;
    font-size: clamp(96px, 9vw, 100px);
    user-select: none;
  }
  .logo .i { color: #1a73e8; }
  .logo .rest { color: #fff; }

  /* Dark overlay with a transparent circle following the cursor */
  .shade {
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: 1;
    /* The radial-gradient creates a transparent spotlight:
       - Transparent up to (r - f)
       - Soft feather from (r - f) to r
       - Dark beyond r
    */
    background:
      radial-gradient(
        circle at var(--mx) var(--my),
        rgba(0, 0, 0, 0) 0,
        rgba(0, 0, 0, 0) calc(var(--r) - var(--f)),
        rgba(0, 0, 0, 0.55) var(--r),
        rgba(0, 0, 0, 0.80) calc(var(--r) + 120px)
      );
    transition: background-position .06s linear;
  }

  /* Optional hint (hidden on very small heights) */
  .hint {
    position: absolute;
    bottom: 6px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 2;
    font: 12px/1.2 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    color: #6b7280;
    opacity: .9;
    white-space: nowrap;
    pointer-events: none;
  }
  @media (max-height: 120px) {
    .hint { display: none; }
  }
</style>
</head>
<body>
  <div id="stage" class="stage" aria-label="Index flashlight doodle. Move your cursor or finger to reveal.">
    <div class="logo" role="img" aria-label="Index logo">
      <span class="i">I</span><span class="rest">ndex</span>
    </div>
    <div id="shade" class="shade" aria-hidden="true"></div>
    <div class="hint">Move mouse/touch to reveal • Scroll to change size</div>
  </div>

<script>
(() => {
  const stage = document.getElementById('stage');

  function setSpot(x, y) {
    stage.style.setProperty('--mx', x + 'px');
    stage.style.setProperty('--my', y + 'px');
  }

  function setRadius(r) {
    const clamped = Math.max(40, Math.min(400, r));
    stage.style.setProperty('--r', clamped + 'px');
    // feather is ~25% of radius (bounded)
    const f = Math.max(14, Math.min(80, clamped * 0.28));
    stage.style.setProperty('--f', f + 'px');
  }

  function updateRadiusFromStageSize() {
    const rect = stage.getBoundingClientRect();
    // Base radius relative to the smallest dimension
    setRadius(Math.max(60, Math.min(rect.width, rect.height) * 0.33));
  }

  // Initialize spotlight at center
  function centerSpot() {
    const rect = stage.getBoundingClientRect();
    setSpot(rect.width * 0.5, rect.height * 0.5);
  }

  // Pointer move = move spotlight
  function onPointerMove(e) {
    const rect = stage.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;
    setSpot(x, y);
  }

  // Touch support: mirror to pointermove
  stage.addEventListener('pointermove', onPointerMove);
  stage.addEventListener('pointerdown', onPointerMove);
  stage.addEventListener('pointerenter', onPointerMove);

  // If pointer leaves, keep the last position (no action).
  stage.addEventListener('pointerleave', () => { /* noop */ });

  // Scroll to adjust radius
  stage.addEventListener('wheel', (e) => {
    e.preventDefault();
    const current = parseFloat(getComputedStyle(stage).getPropertyValue('--r')) || 110;
    const delta = Math.sign(e.deltaY) * -16; // wheel up -> bigger
    setRadius(current + delta);
  }, { passive: false });

  // Keyboard fallback when iframe is focused
  stage.tabIndex = 0;
  stage.addEventListener('keydown', (e) => {
    const step = e.shiftKey ? 24 : 12;
    const rect = stage.getBoundingClientRect();
    const cs = getComputedStyle(stage);
    let x = parseFloat(cs.getPropertyValue('--mx')) || rect.width / 2;
    let y = parseFloat(cs.getPropertyValue('--my')) || rect.height / 2;
    if (e.key === 'ArrowLeft') x -= step;
    else if (e.key === 'ArrowRight') x += step;
    else if (e.key === 'ArrowUp') y -= step;
    else if (e.key === 'ArrowDown') y += step;
    else if (e.key === '+' || e.key === '=') setRadius((parseFloat(cs.getPropertyValue('--r')) || 110) + 12);
    else if (e.key === '-' || e.key === '_') setRadius((parseFloat(cs.getPropertyValue('--r')) || 110) - 12);
    else return;
    e.preventDefault();
    setSpot(Math.max(0, Math.min(rect.width, x)), Math.max(0, Math.min(rect.height, y)));
  });

  // Handle resize and font load (so the logo's size is stable)
  function onResize() {
    updateRadiusFromStageSize();
    centerSpot();
  }
  window.addEventListener('resize', onResize);
  if (document.fonts && document.fonts.ready) {
    document.fonts.ready.then(onResize);
  }

  // Initial setup
  updateRadiusFromStageSize();
  centerSpot();
})();
</script>
</body>
</html>