<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Lumen — Flashlight Doodle</title>
<style>

  :root {
    --mx: 50%;
    --my: 50%;
    --r: 110px;   /* flashlight radius (px) */
    --f: 28px;    /* feather/soft edge (px) */
  }

  /* Dark overlay with a transparent circle following the cursor */
  .shade {
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: 1;
    /* The radial-gradient creates a transparent spotlight:
       - Transparent up to (r - f)
       - Soft feather from (r - f) to r
       - Dark beyond r
    */
    background:
      radial-gradient(
        circle at var(--mx) var(--my),
        rgba(0, 0, 0, 0) 0,
        rgba(0, 0, 0, 0) calc(var(--r) - var(--f)),
        rgba(0, 0, 0, 0.55) var(--r),
        rgba(0, 0, 0, 0.80) calc(var(--r) + 120px)
      );
    transition: background-position .06s linear;
  }
</style>

<link href="/resources/styles/branding.css" rel="stylesheet">
</head>
<body>
  <div id="stage" class="stage" aria-label="Lumen flashlight doodle. Move your cursor or finger to reveal.">
    <div class="logo" role="img" aria-label="Lumen logo">
      <span class="i">L</span><span class="rest">umen</span>
    </div>
    <div id="shade" class="shade" aria-hidden="true"></div>
    <div class="hint">Move mouse/touch to reveal • Scroll to change size</div>
  </div>

<script>
(() => {
  const stage = document.getElementById('stage');

  function setSpot(x, y) {
    stage.style.setProperty('--mx', x + 'px');
    stage.style.setProperty('--my', y + 'px');
  }

  function setRadius(r) {
    const clamped = Math.max(40, Math.min(400, r));
    stage.style.setProperty('--r', clamped + 'px');
    // feather is ~25% of radius (bounded)
    const f = Math.max(14, Math.min(80, clamped * 0.28));
    stage.style.setProperty('--f', f + 'px');
  }

  function updateRadiusFromStageSize() {
    const rect = stage.getBoundingClientRect();
    // Base radius relative to the smallest dimension
    setRadius(Math.max(60, Math.min(rect.width, rect.height) * 0.33));
  }

  // Initialize spotlight at center
  function centerSpot() {
    const rect = stage.getBoundingClientRect();
    setSpot(rect.width * 0.5, rect.height * 0.5);
  }

  // Pointer move = move spotlight
  function onPointerMove(e) {
    const rect = stage.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;
    setSpot(x, y);
  }

  // Touch support: mirror to pointermove
  stage.addEventListener('pointermove', onPointerMove);
  stage.addEventListener('pointerdown', onPointerMove);
  stage.addEventListener('pointerenter', onPointerMove);

  // If pointer leaves, keep the last position (no action).
  stage.addEventListener('pointerleave', () => { /* noop */ });

  // Scroll to adjust radius
  stage.addEventListener('wheel', (e) => {
    e.preventDefault();
    const current = parseFloat(getComputedStyle(stage).getPropertyValue('--r')) || 110;
    const delta = Math.sign(e.deltaY) * -16; // wheel up -> bigger
    setRadius(current + delta);
  }, { passive: false });

  // Keyboard fallback when iframe is focused
  stage.tabIndex = 0;
  stage.addEventListener('keydown', (e) => {
    const step = e.shiftKey ? 24 : 12;
    const rect = stage.getBoundingClientRect();
    const cs = getComputedStyle(stage);
    let x = parseFloat(cs.getPropertyValue('--mx')) || rect.width / 2;
    let y = parseFloat(cs.getPropertyValue('--my')) || rect.height / 2;
    if (e.key === 'ArrowLeft') x -= step;
    else if (e.key === 'ArrowRight') x += step;
    else if (e.key === 'ArrowUp') y -= step;
    else if (e.key === 'ArrowDown') y += step;
    else if (e.key === '+' || e.key === '=') setRadius((parseFloat(cs.getPropertyValue('--r')) || 110) + 12);
    else if (e.key === '-' || e.key === '_') setRadius((parseFloat(cs.getPropertyValue('--r')) || 110) - 12);
    else return;
    e.preventDefault();
    setSpot(Math.max(0, Math.min(rect.width, x)), Math.max(0, Math.min(rect.height, y)));
  });

  // Handle resize and font load (so the logo's size is stable)
  function onResize() {
    updateRadiusFromStageSize();
    centerSpot();
  }
  window.addEventListener('resize', onResize);
  if (document.fonts && document.fonts.ready) {
    document.fonts.ready.then(onResize);
  }

  // Initial setup
  updateRadiusFromStageSize();
  centerSpot();
})();
</script>
</body>
</html>